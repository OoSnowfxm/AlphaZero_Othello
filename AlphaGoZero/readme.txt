代码实现的太久了，这个是不完全版本，有不少错误。

完全版本找不到了，但是这个可以作为参考，大致思路都在。